<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Google Analytics (wird erst nach Cookie-Consent geladen) -->
    <script>
        window.gaLoaded = false;
        function loadGoogleAnalytics() {
            if (window.gaLoaded) return;
            window.gaLoaded = true;
            
            var script = document.createElement('script');
            script.async = true;
            script.src = 'https://www.googletagmanager.com/gtag/js?id=G-F3BQLK365X';
            document.head.appendChild(script);
            
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            window.gtag = gtag;
            gtag('js', new Date());
            gtag('config', 'G-F3BQLK365X', { 'anonymize_ip': true });
            
            console.log('Google Analytics geladen');
        }
        
        // Prüfe ob bereits zugestimmt wurde
        if (localStorage.getItem('cookieConsent') === 'accepted') {
            loadGoogleAnalytics();
        }
    </script>
    
    <!-- SEO Meta Tags -->
    <title>WolfeWaveSignals - Professionelle Wolfe Wave Trading Signale | Echtzeit Alerts</title>
    <meta name="description" content="Erhalte täglich professionelle Wolfe Wave Trading-Signale für DAX, NASDAQ, Forex & Krypto. Automatische Erkennung mit Entry, Stop-Loss und Take-Profit. Jetzt kostenlos testen!">
    <meta name="keywords" content="Wolfe Wave Signale, Trading Signale, Wolfe Wave Scanner, DAX Signale, NASDAQ Signale, Forex Signale, Krypto Signale, technische Analyse, Chartmuster, Trading Alerts">
    <meta name="author" content="WolfeWaveSignals">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://wolfewavesignals.com/">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="WolfeWaveSignals - Professionelle Trading Signale">
    <meta property="og:description" content="Erhalte täglich Wolfe Wave Signale für DAX, NASDAQ, Forex & Krypto. Mit Entry, SL und TP.">
    <meta property="og:url" content="https://wolfewavesignals.com/">
    <meta property="og:site_name" content="WolfeWaveSignals">
    <meta property="og:image" content="https://wolfewavesignals.com/images/og-image.jpg">
    <meta property="og:locale" content="de_DE">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="WolfeWaveSignals - Trading Signale">
    <meta name="twitter:description" content="Professionelle Wolfe Wave Signale für alle Märkte.">
    <meta name="twitter:image" content="https://wolfewavesignals.com/images/twitter-card.jpg">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="manifest" href="/site.webmanifest">
    
    <!-- Schema.org Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "name": "WolfeWaveSignals",
        "url": "https://wolfewavesignals.com",
        "description": "Professionelle Wolfe Wave Trading-Signale für DAX, NASDAQ, Forex und Krypto",
        "potentialAction": {
            "@type": "SearchAction",
            "target": "https://wolfewavesignals.com/?search={search_term_string}",
            "query-input": "required name=search_term_string"
        }
    }
    </script>
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "WolfeWaveSignals",
        "url": "https://wolfewavesignals.com",
        "logo": "https://wolfewavesignals.com/images/logo.png",
        "contactPoint": {
            "@type": "ContactPoint",
            "email": "walserfly@gmail.com",
            "contactType": "customer service"
        },
        "sameAs": []
    }
    </script>
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Product",
        "name": "WolfeWaveSignals Premium",
        "description": "Alle Wolfe Wave Trading-Signale in Echtzeit",
        "offers": {
            "@type": "Offer",
            "price": "19.90",
            "priceCurrency": "EUR",
            "availability": "https://schema.org/InStock"
        }
    }
    </script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0c0c0c;
            --bg-card: #141414;
            --bg-hover: #1a1a1a;
            --accent-green: #00ff88;
            --accent-lightgreen: #7dff7d;
            --accent-red: #ff4757;
            --accent-gold: #ffd700;
            --accent-blue: #4dabf7;
            --text-primary: #ffffff;
            --text-secondary: #6b7280;
            --border-color: #1f1f1f;
            --grid-columns: 4;
        }

        body {
            font-family: 'Space Grotesk', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.5;
        }

        /* Header */
        .header {
            padding: 20px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border-color);
            position: sticky;
            top: 0;
            background: rgba(12, 12, 12, 0.95);
            backdrop-filter: blur(10px);
            z-index: 100;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 22px;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        .logo-icon {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, var(--accent-green), #00cc6a);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .logo span {
            color: var(--accent-green);
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .header-nav {
            display: flex;
            align-items: center;
            gap: 24px;
            margin-left: 40px;
        }

        .nav-link {
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            transition: color 0.2s;
            white-space: nowrap;
        }

        .nav-link:hover {
            color: var(--accent-green);
        }

        .header-success-rate {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(0, 230, 118, 0.1);
            border: 1px solid rgba(0, 230, 118, 0.3);
            border-radius: 20px;
            padding: 6px 14px;
        }

        .success-label {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .success-value {
            font-size: 14px;
            font-weight: 700;
            color: var(--accent-green);
        }

        .live-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: var(--text-secondary);
        }

        .live-dot {
            width: 8px;
            height: 8px;
            background: var(--accent-green);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.2); }
        }

        .btn {
            padding: 10px 20px;
            border-radius: 8px;
            font-family: inherit;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
        }

        .btn-outline {
            background: transparent;
            border: 1px solid var(--border-color);
            color: var(--text-primary);
        }

        .btn-outline:hover {
            border-color: var(--accent-green);
            color: var(--accent-green);
        }

        .btn-primary {
            background: var(--accent-green);
            color: #000;
        }

        .btn-primary:hover {
            background: #00cc6a;
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(0, 255, 136, 0.3);
        }

        /* Hero Section */
        .hero {
            padding: 60px 40px;
            text-align: center;
            background: linear-gradient(180deg, rgba(0, 255, 136, 0.03) 0%, transparent 100%);
        }

        .hero h1 {
            font-size: 48px;
            font-weight: 700;
            margin-bottom: 16px;
            letter-spacing: -1px;
        }

        .hero h1 span {
            color: var(--accent-green);
        }

        .hero p {
            font-size: 18px;
            color: var(--text-secondary);
            max-width: 600px;
            margin: 0 auto;
        }

        /* Section Header */
        .section-header {
            padding: 24px 40px 16px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-badge {
            background: var(--accent-green);
            color: #000;
            font-size: 10px;
            font-weight: 700;
            padding: 4px 10px;
            border-radius: 4px;
            text-transform: uppercase;
        }

        .section-subtitle {
            color: var(--text-secondary);
            font-size: 14px;
        }

        /* Stats */
        .stats-section {
            padding: 0 40px 24px;
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
        }

        .stat-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 16px 24px;
            min-width: 120px;
        }

        .stat-number {
            font-size: 28px;
            font-weight: 700;
            color: var(--accent-green);
        }

        .stat-gold {
            color: var(--accent-gold);
        }

        .stat-label {
            font-size: 12px;
            color: var(--text-secondary);
            margin-top: 2px;
        }

        /* Tabs Section */
        .tabs-section {
            padding: 20px 40px;
            display: none;
        }

        .tabs-section.visible {
            display: block;
        }

        .tabs-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 16px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 16px;
        }

        .tabs {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .tab {
            padding: 10px 20px;
            background: transparent;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-secondary);
            font-family: inherit;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tab:hover {
            border-color: var(--accent-green);
            color: var(--text-primary);
        }

        .tab.active {
            background: var(--accent-green);
            border-color: var(--accent-green);
            color: #000;
        }

        .tab-badge {
            background: rgba(0, 255, 136, 0.2);
            color: var(--accent-green);
            font-size: 10px;
            font-weight: 700;
            padding: 2px 6px;
            border-radius: 10px;
        }

        .tab.active .tab-badge {
            background: rgba(0, 0, 0, 0.2);
            color: #000;
        }

        /* Success Tab Special Styling */
        .tab-success {
            border-color: rgba(255, 215, 0, 0.3);
        }

        .tab-success:hover {
            border-color: var(--accent-gold);
            color: var(--accent-gold);
        }

        .tab-success.active {
            background: var(--accent-gold);
            border-color: var(--accent-gold);
            color: #000;
        }

        .tab-badge-gold {
            background: rgba(255, 215, 0, 0.2);
            color: var(--accent-gold);
        }

        .tab-success.active .tab-badge-gold {
            background: rgba(0, 0, 0, 0.2);
            color: #000;
        }

        .filters {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .filter-select {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 10px 16px;
            border-radius: 8px;
            font-family: inherit;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .filter-select:hover {
            border-color: var(--accent-green);
        }

        .filter-select:focus {
            outline: none;
            border-color: var(--accent-green);
        }

        /* Search Box */
        .search-box {
            position: relative;
            display: flex;
            align-items: center;
        }

        .search-icon {
            position: absolute;
            left: 12px;
            font-size: 14px;
            pointer-events: none;
        }

        .search-input {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 10px 16px 10px 38px;
            border-radius: 8px;
            font-family: inherit;
            font-size: 13px;
            width: 280px;
            transition: all 0.2s;
        }

        .search-input::placeholder {
            color: var(--text-secondary);
        }

        .search-input:hover {
            border-color: var(--accent-green);
        }

        .search-input:focus {
            outline: none;
            border-color: var(--accent-green);
            box-shadow: 0 0 0 3px rgba(0, 255, 136, 0.1);
        }

        /* Search Results Highlight */
        .signal-card.search-match {
            border-color: rgba(0, 255, 136, 0.6);
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.2);
        }

        .no-results {
            grid-column: 1 / -1;
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary);
        }

        .no-results-icon {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .no-results h3 {
            font-size: 18px;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        /* Admin Controls */
        .admin-controls {
            position: absolute;
            top: 12px;
            right: 12px;
            display: flex;
            gap: 6px;
            z-index: 20;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .signal-card:hover .admin-controls {
            opacity: 1;
        }

        .admin-controls.always-visible {
            opacity: 1 !important;
            top: 8px;
            right: 8px;
        }

        .admin-controls.always-visible .admin-btn {
            width: 44px;
            height: 44px;
            font-size: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
        }

        .admin-btn {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            backdrop-filter: blur(8px);
        }

        .admin-btn-success {
            background: rgba(0, 255, 136, 0.9);
            color: #000;
        }

        .admin-btn-success:hover {
            background: var(--accent-green);
            transform: scale(1.1);
        }

        .admin-btn-delete {
            background: rgba(255, 71, 87, 0.9);
            color: #fff;
        }

        .admin-btn-delete:hover {
            background: var(--accent-red);
            transform: scale(1.1);
        }

        /* Admin Modal */
        .admin-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .admin-modal.active {
            display: flex;
        }

        .admin-modal-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 32px;
            max-width: 500px;
            width: 90%;
        }

        .admin-modal-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
        }

        .admin-modal-header h3 {
            font-size: 20px;
            font-weight: 600;
        }

        .admin-modal-body {
            margin-bottom: 24px;
        }

        .admin-modal-body p {
            color: var(--text-secondary);
            margin-bottom: 16px;
        }

        .admin-form-group {
            margin-bottom: 16px;
        }

        .admin-form-group label {
            display: block;
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .admin-form-group select {
            width: 100%;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 12px;
            border-radius: 8px;
            font-family: inherit;
            font-size: 14px;
        }

        .admin-form-group select:focus {
            outline: none;
            border-color: var(--accent-green);
        }

        .admin-modal-footer {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }

        .admin-modal-btn {
            padding: 12px 24px;
            border-radius: 8px;
            font-family: inherit;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
        }

        .admin-modal-btn-cancel {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .admin-modal-btn-cancel:hover {
            background: var(--border-color);
        }

        .admin-modal-btn-danger {
            background: var(--accent-red);
            color: #fff;
        }

        .admin-modal-btn-danger:hover {
            background: #ff6b7a;
        }

        .admin-modal-btn-success {
            background: var(--accent-green);
            color: #000;
        }

        .admin-modal-btn-success:hover {
            background: #00cc6a;
        }

        /* Admin indicator */
        .admin-badge {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--accent-gold);
            color: #000;
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 700;
            display: none;
            z-index: 100;
        }

        .admin-badge.visible {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* Success Stats Bar (compact) */
        .success-stats-bar {
            display: none;
            padding: 20px 40px;
            background: linear-gradient(180deg, rgba(255, 215, 0, 0.05) 0%, transparent 100%);
            border-bottom: 1px solid var(--border-color);
        }

        .success-stats-bar.visible {
            display: block;
        }

        .success-stats-grid {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .success-stat-mini {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 16px 24px;
            text-align: center;
            min-width: 120px;
        }

        .success-stat-mini.gold {
            border-color: rgba(255, 215, 0, 0.3);
        }

        .success-stat-mini.green {
            border-color: rgba(0, 255, 136, 0.3);
        }

        .success-stat-mini.blue {
            border-color: rgba(77, 171, 247, 0.3);
        }

        .success-stat-mini.red {
            border-color: rgba(255, 71, 87, 0.3);
        }

        .success-stat-mini .stat-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }

        .success-stat-mini .stat-value {
            font-size: 28px;
            font-weight: 700;
        }

        .success-stat-mini .stat-value.gold { color: var(--accent-gold); }
        .success-stat-mini .stat-value.green { color: var(--accent-green); }
        .success-stat-mini .stat-value.blue { color: var(--accent-blue); }
        .success-stat-mini .stat-value.red { color: var(--accent-red); }

        .success-stat-mini .stat-label {
            font-size: 11px;
            color: var(--text-secondary);
            margin-top: 4px;
        }

        .success-rate-display {
            background: var(--bg-card);
            border: 1px solid var(--accent-gold);
            border-radius: 12px;
            padding: 16px 32px;
            text-align: center;
        }

        .success-rate-display .rate-value {
            font-size: 36px;
            font-weight: 700;
            color: var(--accent-gold);
        }

        .success-rate-display .rate-label {
            font-size: 12px;
            color: var(--text-secondary);
        }

        /* Main Grid */
        .main {
            padding: 0 40px 40px;
        }

        .signals-grid {
            display: grid;
            grid-template-columns: repeat(var(--grid-columns, 4), 1fr);
            gap: 20px;
        }

        /* Zoom Controls */
        .zoom-controls {
            display: flex;
            align-items: center;
            gap: 4px;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 4px 8px;
            margin-left: 12px;
        }

        .zoom-btn {
            width: 28px;
            height: 28px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            font-size: 16px;
            cursor: pointer;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .zoom-btn:hover {
            background: rgba(0, 230, 118, 0.2);
            color: var(--accent-green);
        }

        .zoom-btn-full {
            font-size: 12px;
            margin-left: 4px;
            border-left: 1px solid var(--border-color);
            padding-left: 8px;
        }

        .zoom-indicator {
            font-size: 12px;
            color: var(--text-secondary);
            min-width: 20px;
            text-align: center;
        }

        /* Signal Card */
        .signal-card {
            background: var(--bg-card);
            border-radius: 16px;
            overflow: hidden;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .signal-card:hover {
            border-color: rgba(0, 255, 136, 0.3);
            transform: translateY(-4px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
        }

        .signal-card.is-new {
            border-color: rgba(0, 255, 136, 0.5);
            animation: glowNew 3s ease-in-out infinite;
        }

        @keyframes glowNew {
            0%, 100% { box-shadow: 0 0 20px rgba(0, 255, 136, 0.2); }
            50% { box-shadow: 0 0 40px rgba(0, 255, 136, 0.4); }
        }

        /* Success Card Styling */
        .signal-card.is-success {
            border-color: rgba(255, 215, 0, 0.4);
        }

        .signal-card.is-success:hover {
            border-color: var(--accent-gold);
            box-shadow: 0 20px 40px rgba(255, 215, 0, 0.2);
        }

        .signal-card.is-success.tp3 {
            border-color: rgba(255, 215, 0, 0.5);
        }

        .signal-card.is-success.tp2 {
            border-color: rgba(0, 255, 136, 0.5);
        }

        .signal-card.is-success.tp1 {
            border-color: rgba(77, 171, 247, 0.5);
        }

        .signal-card.is-failed {
            border-color: rgba(255, 71, 87, 0.4);
        }

        .new-badge {
            position: absolute;
            top: 16px;
            left: 16px;
            background: var(--accent-green);
            color: #000;
            font-size: 10px;
            font-weight: 700;
            padding: 4px 10px;
            border-radius: 4px;
            z-index: 10;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .preview-badge {
            position: absolute;
            top: 16px;
            left: 16px;
            background: linear-gradient(135deg, #00ff88, #00cc6a);
            color: #000;
            font-size: 10px;
            font-weight: 700;
            padding: 4px 10px;
            border-radius: 4px;
            z-index: 10;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .result-badge {
            position: absolute;
            top: 16px;
            left: 16px;
            font-size: 10px;
            font-weight: 700;
            padding: 4px 10px;
            border-radius: 4px;
            z-index: 10;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .result-badge.tp3 {
            background: var(--accent-gold);
            color: #000;
        }

        .result-badge.tp2 {
            background: var(--accent-green);
            color: #000;
        }

        .result-badge.tp1 {
            background: var(--accent-blue);
            color: #000;
        }

        .result-badge.sl {
            background: var(--accent-red);
            color: #fff;
        }

        /* Image Section - ERHÖHT für bessere Sichtbarkeit */
        .signal-image-container {
            position: relative;
            height: 280px;
            overflow: hidden;
        }

        /* Vollbild-Modus (1 Spalte) - Bild mit besserem Seitenverhältnis */
        .signals-grid.fullscreen-mode .signal-image-container {
            height: 500px;
            max-height: 55vh;
        }

        .signals-grid.fullscreen-mode .signal-card {
            max-width: 1000px;
            margin: 0 auto;
        }

        .signals-grid.fullscreen-mode .signal-image {
            object-fit: contain;
            background: #1a1a1a;
        }

        .signals-grid.fullscreen-mode .signal-info {
            padding: 20px 24px 24px;
        }

        .signals-grid.fullscreen-mode .price-grid {
            padding: 16px;
        }

        .signals-grid.fullscreen-mode .price-value {
            font-size: 14px;
        }

        .signal-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s;
        }

        .signal-card:hover .signal-image {
            transform: scale(1.02);
        }

        .signal-badge {
            position: absolute;
            top: 16px;
            right: 16px;
            padding: 6px 14px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 700;
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }

        .badge-bullish {
            background: var(--accent-green);
            color: #000;
        }

        .badge-bearish {
            background: var(--accent-red);
            color: #fff;
        }

        .signal-tags {
            position: absolute;
            bottom: 16px;
            left: 16px;
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .signal-tag {
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(4px);
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 500;
            color: #fff;
        }

        /* Info Section */
        .signal-info {
            padding: 16px 20px 20px;
        }

        .signal-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 14px;
        }

        .signal-title {
            font-size: 15px;
            font-weight: 600;
            color: var(--text-primary);
            line-height: 1.3;
        }

        .signal-symbol {
            font-size: 11px;
            color: var(--text-secondary);
            margin-top: 2px;
        }

        .signal-time {
            text-align: right;
        }

        .signal-date {
            font-size: 11px;
            color: var(--text-secondary);
        }

        .signal-ago {
            font-size: 10px;
            color: var(--accent-green);
            margin-top: 2px;
        }

        /* Price Grid - MIT FARBKODIERUNG */
        .price-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 10px;
            padding: 12px;
        }

        .price-item {
            text-align: center;
        }

        .price-label {
            font-size: 8px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 2px;
        }

        /* Farbkodierte Labels */
        .price-label.entry { color: var(--accent-blue); }
        .price-label.stop { color: var(--accent-red); }
        .price-label.tp1 { color: var(--accent-lightgreen); }
        .price-label.tp2 { color: var(--accent-green); }
        .price-label.tp3 { color: var(--accent-gold); }

        .price-value {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-primary);
        }

        /* Farbkodierte Werte */
        .price-value.entry { color: var(--accent-blue); }
        .price-value.stop { color: var(--accent-red); }
        .price-value.tp1 { color: var(--accent-lightgreen); }
        .price-value.tp2 { color: var(--accent-green); }
        .price-value.tp3 { color: var(--accent-gold); }

        .price-pct {
            font-size: 9px;
            margin-top: 1px;
        }

        .pct-green { color: var(--accent-green); }
        .pct-red { color: var(--accent-red); }

        /* RR Badge */
        .rr-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            margin-top: 12px;
            padding: 6px 12px;
            background: rgba(0, 255, 136, 0.1);
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
        }

        .rr-badge span {
            color: var(--accent-green);
        }

        /* Premium Section / Paywall */
        .premium-section {
            position: relative;
            margin-top: 40px;
        }

        .premium-header {
            padding: 24px 40px 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .premium-title {
            font-size: 18px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .lock-icon {
            font-size: 20px;
        }

        .premium-count {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .premium-grid-container {
            position: relative;
            padding: 0 40px;
        }

        .premium-grid {
            display: grid;
            grid-template-columns: repeat(var(--grid-columns, 4), 1fr);
            gap: 20px;
            filter: blur(8px);
            pointer-events: none;
            user-select: none;
        }

        /* Locked Card */
        .signal-card-locked {
            background: var(--bg-card);
            border-radius: 16px;
            overflow: hidden;
            border: 1px solid var(--border-color);
            position: relative;
        }

        .signal-card-locked .signal-image-container {
            background: linear-gradient(135deg, #1a1a1a 0%, #0c0c0c 100%);
        }

        .signal-card-locked .placeholder-image {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            opacity: 0.3;
        }

        /* Paywall Overlay */
        .paywall-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(180deg, transparent 0%, rgba(12, 12, 12, 0.95) 30%);
            z-index: 10;
        }

        .paywall-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            padding: 40px 50px;
            text-align: center;
            max-width: 500px;
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.5);
        }

        .paywall-icon {
            font-size: 48px;
            margin-bottom: 20px;
        }

        .paywall-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 12px;
        }

        .paywall-title span {
            color: var(--accent-green);
        }

        .paywall-subtitle {
            color: var(--text-secondary);
            font-size: 16px;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .paywall-features {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 30px;
            text-align: left;
        }

        .paywall-feature {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 14px;
        }

        .paywall-feature-icon {
            color: var(--accent-green);
            font-size: 18px;
        }

        .paywall-price {
            margin-bottom: 24px;
        }

        .paywall-price-amount {
            font-size: 48px;
            font-weight: 700;
            color: var(--accent-green);
        }

        .paywall-price-period {
            font-size: 16px;
            color: var(--text-secondary);
        }

        .paywall-btn {
            width: 100%;
            padding: 16px 32px;
            font-size: 16px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--accent-green), #00cc6a);
            color: #000;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .paywall-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0, 255, 136, 0.4);
        }

        .paywall-login {
            margin-top: 16px;
            font-size: 13px;
            color: var(--text-secondary);
        }

        .paywall-login a {
            color: var(--accent-green);
            text-decoration: none;
        }

        .paywall-login a:hover {
            text-decoration: underline;
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 30px;
            color: var(--text-secondary);
            font-size: 12px;
            border-top: 1px solid var(--border-color);
        }

        .footer a:hover {
            color: var(--accent-green) !important;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal.active {
            display: flex;
        }

        .modal img {
            max-width: 90%;
            max-height: 90vh;
            border-radius: 12px;
        }

        .modal-close {
            position: absolute;
            top: 30px;
            right: 40px;
            font-size: 32px;
            color: #fff;
            cursor: pointer;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .modal-close:hover {
            opacity: 1;
        }

        /* Image Slider - ECHTE PFEILE */
        .image-slider-container {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            max-width: 95%;
            max-height: 95vh;
        }

        .slider-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid var(--accent-green);
            color: var(--accent-green);
            font-size: 32px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            cursor: pointer;
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            font-family: Arial, sans-serif;
            line-height: 1;
            font-weight: bold;
        }

        .slider-nav:hover {
            background: var(--accent-green);
            color: #000;
        }

        .slider-nav:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .slider-nav.hidden {
            display: none;
        }

        .slider-prev { left: -80px; }
        .slider-next { right: -80px; }

        .slider-info {
            display: flex;
            gap: 20px;
            margin-top: 16px;
            padding: 10px 20px;
            background: rgba(0, 0, 0, 0.8);
            border-radius: 8px;
            color: var(--text-secondary);
            font-size: 14px;
        }

        .slider-info #sliderCounter {
            color: var(--accent-green);
            font-weight: 600;
        }

        .slider-thumbnails {
            display: flex;
            gap: 8px;
            margin-top: 16px;
            max-width: 100%;
            overflow-x: auto;
            padding: 8px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 8px;
        }

        .slider-thumbnails:empty {
            display: none;
        }

        .slider-thumb {
            width: 80px;
            height: 45px;
            object-fit: cover;
            border-radius: 4px;
            cursor: pointer;
            opacity: 0.5;
            transition: all 0.2s;
            border: 2px solid transparent;
        }

        .slider-thumb:hover {
            opacity: 0.8;
        }

        .slider-thumb.active {
            opacity: 1;
            border-color: var(--accent-green);
        }

        @media (max-width: 1200px) {
            .slider-prev { left: 10px; }
            .slider-next { right: 10px; }
            .slider-nav {
                width: 50px;
                height: 50px;
                font-size: 28px;
                background: rgba(0, 0, 0, 0.8);
            }
        }

        @media (max-width: 768px) {
            .slider-nav {
                width: 40px;
                height: 40px;
                font-size: 22px;
            }
            .slider-thumbnails {
                display: none;
            }
        }

        /* Loading */
        .loading {
            grid-column: 1 / -1;
            text-align: center;
            padding: 80px 20px;
            color: var(--text-secondary);
        }

        .spinner {
            width: 48px;
            height: 48px;
            border: 3px solid var(--border-color);
            border-top-color: var(--accent-green);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Auth styles */
        .auth-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            padding: 40px;
            width: 100%;
            max-width: 420px;
            position: relative;
            margin: 20px;
        }

        .auth-card .modal-close {
            position: absolute;
            top: 16px;
            right: 20px;
            font-size: 24px;
        }

        .auth-header {
            text-align: center;
            margin-bottom: 32px;
        }

        .auth-icon {
            font-size: 48px;
            margin-bottom: 16px;
        }

        .auth-header h2 {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .auth-header p {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .auth-fields {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 24px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .input-group label {
            font-size: 13px;
            font-weight: 500;
            color: var(--text-secondary);
        }

        .input-group input {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 14px 16px;
            font-size: 15px;
            font-family: inherit;
            color: var(--text-primary);
            transition: all 0.2s;
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--accent-green);
            box-shadow: 0 0 0 3px rgba(0, 255, 136, 0.1);
        }

        .auth-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, var(--accent-green), #00cc6a);
            color: #000;
            border: none;
            border-radius: 12px;
            font-size: 15px;
            font-weight: 700;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.3s;
        }

        .auth-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 255, 136, 0.3);
        }

        .auth-error {
            color: var(--accent-red);
            font-size: 13px;
            text-align: center;
            margin-bottom: 16px;
        }

        .auth-footer {
            margin-top: 24px;
            text-align: center;
            font-size: 13px;
            color: var(--text-secondary);
        }

        .auth-footer a {
            color: var(--accent-green);
            text-decoration: none;
        }

        /* User menu */
        .user-menu-container {
            position: relative;
        }

        .user-menu-trigger {
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 10px;
            transition: all 0.2s;
        }

        .user-menu-trigger:hover {
            background: var(--bg-hover);
        }

        .user-avatar {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, var(--accent-green), #00cc6a);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            font-weight: 700;
            color: #000;
        }

        .user-info {
            display: flex;
            flex-direction: column;
        }

        .user-email {
            font-size: 13px;
            font-weight: 500;
        }

        .user-status {
            font-size: 11px;
            color: var(--accent-green);
        }

        .user-dropdown {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            min-width: 200px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.2s ease;
            z-index: 1000;
        }

        .user-menu-container.open .user-dropdown {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .dropdown-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.2s;
        }

        .dropdown-item:hover {
            background: var(--bg-hover);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header {
                padding: 16px 20px;
                flex-direction: column;
                gap: 16px;
            }

            .header-nav {
                margin-left: 0;
                width: 100%;
                justify-content: center;
                gap: 16px;
            }

            .header-success-rate {
                padding: 4px 10px;
            }

            .success-label {
                display: none;
            }

            .header-right {
                width: 100%;
                justify-content: space-between;
            }

            .hero {
                padding: 40px 20px;
            }

            .hero h1 {
                font-size: 32px;
            }

            .section-header, .stats-section, .main, .premium-header, .premium-grid-container, .tabs-section {
                padding-left: 16px;
                padding-right: 16px;
            }

            .signals-grid, .premium-grid {
                grid-template-columns: 1fr !important;
            }

            .zoom-controls {
                display: none;
            }

            .signal-image-container {
                height: 220px;
            }

            .paywall-card {
                margin: 20px;
                padding: 30px 24px;
            }

            .paywall-price-amount {
                font-size: 36px;
            }

            .tabs {
                width: 100%;
                overflow-x: auto;
                padding-bottom: 8px;
            }

            .filters {
                width: 100%;
            }

            .filter-select {
                flex: 1;
            }

            .search-input {
                width: 100%;
            }

            .search-box {
                width: 100%;
            }

            .success-stats-grid {
                justify-content: flex-start;
                overflow-x: auto;
                padding-bottom: 8px;
            }
        }

        /* Cookie Banner */
        .cookie-banner {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--bg-card);
            border-top: 1px solid var(--border-color);
            padding: 20px;
            z-index: 9999;
            display: none;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.5);
        }

        /* Checkout Consent Modal */
        .checkout-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .checkout-modal.active {
            display: flex;
        }

        .checkout-modal-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            padding: 32px;
            max-width: 500px;
            width: 90%;
            margin: 20px;
        }

        .checkout-modal-header {
            text-align: center;
            margin-bottom: 24px;
        }

        .checkout-modal-header .icon {
            font-size: 48px;
            margin-bottom: 16px;
        }

        .checkout-modal-header h3 {
            font-size: 24px;
            margin-bottom: 8px;
        }

        .checkout-modal-header p {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .checkout-modal-price {
            text-align: center;
            margin-bottom: 24px;
            padding: 16px;
            background: rgba(0, 255, 136, 0.1);
            border-radius: 12px;
        }

        .checkout-modal-price .amount {
            font-size: 36px;
            font-weight: 700;
            color: var(--accent-green);
        }

        .checkout-modal-price .period {
            color: var(--text-secondary);
        }

        .consent-checkbox {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 16px;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            margin-bottom: 20px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .consent-checkbox:hover {
            border-color: var(--accent-green);
        }

        .consent-checkbox.checked {
            border-color: var(--accent-green);
            background: rgba(0, 255, 136, 0.05);
        }

        .consent-checkbox input {
            width: 20px;
            height: 20px;
            margin-top: 2px;
            cursor: pointer;
            accent-color: var(--accent-green);
        }

        .consent-checkbox label {
            font-size: 13px;
            color: var(--text-secondary);
            line-height: 1.5;
            cursor: pointer;
        }

        .consent-checkbox label a {
            color: var(--accent-green);
            text-decoration: none;
        }

        .consent-checkbox label a:hover {
            text-decoration: underline;
        }

        .checkout-modal-buttons {
            display: flex;
            gap: 12px;
        }

        .checkout-modal-buttons button {
            flex: 1;
            padding: 14px 20px;
            border-radius: 10px;
            font-family: inherit;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
        }

        .btn-checkout-cancel {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .btn-checkout-cancel:hover {
            background: var(--border-color);
        }

        .btn-checkout-confirm {
            background: var(--text-secondary);
            color: #000;
            cursor: not-allowed;
            opacity: 0.5;
        }

        .btn-checkout-confirm.enabled {
            background: var(--accent-green);
            cursor: pointer;
            opacity: 1;
        }

        .btn-checkout-confirm.enabled:hover {
            background: #00cc6a;
            transform: translateY(-2px);
        }

        .cookie-banner.visible {
            display: block;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from { transform: translateY(100%); }
            to { transform: translateY(0); }
        }

        .cookie-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 24px;
            flex-wrap: wrap;
        }

        .cookie-text {
            flex: 1;
            min-width: 300px;
        }

        .cookie-text h4 {
            font-size: 16px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .cookie-text p {
            font-size: 13px;
            color: var(--text-secondary);
            margin: 0;
            line-height: 1.5;
        }

        .cookie-text a {
            color: var(--accent-green);
            text-decoration: none;
        }

        .cookie-text a:hover {
            text-decoration: underline;
        }

        .cookie-buttons {
            display: flex;
            gap: 12px;
            flex-shrink: 0;
        }

        .cookie-btn {
            padding: 12px 24px;
            border-radius: 8px;
            font-family: inherit;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
        }

        .cookie-btn-accept {
            background: var(--accent-green);
            color: #000;
        }

        .cookie-btn-accept:hover {
            background: #00cc6a;
        }

        .cookie-btn-decline {
            background: transparent;
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
        }

        .cookie-btn-decline:hover {
            border-color: var(--text-secondary);
            color: var(--text-primary);
        }

        @media (max-width: 768px) {
            .cookie-content {
                flex-direction: column;
                text-align: center;
            }
            .cookie-buttons {
                width: 100%;
                justify-content: center;
            }
            .cookie-text {
                min-width: auto;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="logo">
            <div class="logo-icon">🦊</div>
            <div>Wolfe<span>Wave</span>Signals</div>
        </div>
        <nav class="header-nav">
            <a href="wolfewaves.html" class="nav-link">📖 Tutorial</a>
            <div class="header-success-rate" id="headerSuccessRate">
                <span class="success-label">Success Rate:</span>
                <span class="success-value" id="headerSuccessValue">—%</span>
            </div>
        </nav>
        <div class="header-right">
            <div class="live-indicator">
                <div class="live-dot"></div>
                <span>LIVE</span>
            </div>
            <button class="btn btn-outline" onclick="showLogin()">Login</button>
            <button class="btn btn-primary" onclick="showCheckout()">Abo 19,90€/Monat</button>
        </div>
    </header>

    <section class="hero">
        <h1>Professionelle <span>Wolfe Wave</span> Signale</h1>
        <p>Erhalte täglich hochwertige Trading-Signale mit präzisen Entry-, Stop-Loss- und Take-Profit-Levels</p>
    </section>

    <!-- Stats -->
    <section class="stats-section">
        <div class="stat-card">
            <div class="stat-number" id="totalSignals">—</div>
            <div class="stat-label">Aktive Signale</div>
        </div>
        <div class="stat-card">
            <div class="stat-number stat-gold" id="successCount">—</div>
            <div class="stat-label">✔ Erfolgreiche Trades</div>
        </div>
        <div class="stat-card">
            <div class="stat-number" id="todayCount">—</div>
            <div class="stat-label">Neu heute</div>
        </div>
    </section>

    <!-- Tabs & Filters (nur für Premium) -->
    <section class="tabs-section" id="tabsSection">
        <div class="tabs-container">
            <div class="tabs">
                <button class="tab active" data-tab="all">Alle Signale</button>
                <button class="tab" data-tab="new">
                    Neu
                    <span class="tab-badge" id="newCount">0</span>
                </button>
                <button class="tab" data-tab="bullish">Bullish</button>
                <button class="tab" data-tab="bearish">Bearish</button>
                <button class="tab tab-success" data-tab="success">
                    🏆 Success
                    <span class="tab-badge tab-badge-gold" id="successTabCount">0</span>
                </button>
            </div>
            <div class="filters">
                <div class="search-box">
                    <span class="search-icon">🔍</span>
                    <input type="text" class="search-input" id="searchSymbol" placeholder="Symbol suchen... (z.B. Henkel, Apple, EURUSD)">
                </div>
                <select class="filter-select" id="filterMarket">
                    <option value="">Alle Märkte</option>
                    <option value="DAX">DAX</option>
                    <option value="NASDAQ">NASDAQ</option>
                    <option value="NYSE">NYSE</option>
                    <option value="SP500">S&P 500</option>
                    <option value="FOREX">Forex</option>
                    <option value="CRYPTO">Krypto</option>
                    <option value="OTHER">Andere</option>
                </select>
                <select class="filter-select" id="filterTimeframe">
                    <option value="">Alle TF</option>
                    <option value="M5">M5</option>
                    <option value="M15">M15</option>
                    <option value="H1">H1</option>
                    <option value="H4">H4</option>
                    <option value="D1">Daily</option>
                    <option value="W1">Weekly</option>
                </select>
                <div class="zoom-controls">
                    <button class="zoom-btn" onclick="zoomOut()" title="Mehr Kacheln pro Zeile">−</button>
                    <span class="zoom-indicator" id="zoomIndicator">4</span>
                    <button class="zoom-btn" onclick="zoomIn()" title="Weniger Kacheln pro Zeile">+</button>
                    <button class="zoom-btn zoom-btn-full" onclick="zoomFull()" title="Vollbild (1 Kachel)">⬜</button>
                </div>
            </div>
        </div>
    </section>

    <!-- Success Stats Bar (nur sichtbar bei Success Tab) -->
    <section class="success-stats-bar" id="successStatsBar">
        <div class="success-stats-grid">
            <div class="success-rate-display">
                <div class="rate-value" id="successRateValue">—%</div>
                <div class="rate-label">Success Rate</div>
            </div>
            <div class="success-stat-mini gold">
                <div class="stat-icon">🏆</div>
                <div class="stat-value gold" id="tp3Count">0</div>
                <div class="stat-label">TP3 erreicht</div>
            </div>
            <div class="success-stat-mini green">
                <div class="stat-icon">✅</div>
                <div class="stat-value green" id="tp2Count">0</div>
                <div class="stat-label">TP2 erreicht</div>
            </div>
            <div class="success-stat-mini blue">
                <div class="stat-icon">📈</div>
                <div class="stat-value blue" id="tp1Count">0</div>
                <div class="stat-label">TP1 erreicht</div>
            </div>
            <div class="success-stat-mini red">
                <div class="stat-icon">🛑</div>
                <div class="stat-value red" id="slCount">0</div>
                <div class="stat-label">Stop Loss</div>
            </div>
        </div>
    </section>

    <!-- Free Preview Section -->
    <section class="section-header" id="previewHeader">
        <div class="section-title">
            🎁 Kostenlose Vorschau
            <span class="section-badge">Gratis</span>
        </div>
        <div class="section-subtitle">— Sieh dir 3 echte Signale an</div>
    </section>

    <main class="main">
        <div class="signals-grid" id="previewGrid">
            <div class="loading">
                <div class="spinner"></div>
                <p>Lade Signale...</p>
            </div>
        </div>
    </main>

    <!-- Premium / Locked Section -->
    <section class="premium-section" id="premiumSection">
        <div class="premium-header">
            <div class="premium-title">
                <span class="lock-icon">🔒</span>
                Premium Signale
            </div>
            <div class="premium-count" id="premiumCount">+42 weitere Signale</div>
        </div>

        <div class="premium-grid-container">
            <div class="premium-grid" id="lockedGrid"></div>

            <div class="paywall-overlay">
                <div class="paywall-card">
                    <div class="paywall-icon">🔓</div>
                    <div class="paywall-title">Alle <span>Signale</span> freischalten</div>
                    <div class="paywall-subtitle">
                        Erhalte sofortigen Zugriff auf alle aktuellen und zukünftigen Trading-Signale
                    </div>

                    <div class="paywall-features">
                        <div class="paywall-feature">
                            <span class="paywall-feature-icon">✔</span>
                            <span>Alle Signale in Echtzeit (DAX, NASDAQ, Forex & mehr)</span>
                        </div>
                        <div class="paywall-feature">
                            <span class="paywall-feature-icon">✔</span>
                            <span>Performance-Statistiken & Success-Tracking</span>
                        </div>
                        <div class="paywall-feature">
                            <span class="paywall-feature-icon">✔</span>
                            <span>Detaillierte Chart-Analysen mit Entry/SL/TP</span>
                        </div>
                        <div class="paywall-feature">
                            <span class="paywall-feature-icon">✔</span>
                            <span>Jederzeit kündbar — keine Bindung</span>
                        </div>
                    </div>

                    <div class="paywall-price">
                        <span class="paywall-price-amount">19,90€</span>
                        <span class="paywall-price-period">/ Monat</span>
                    </div>

                    <button class="paywall-btn" onclick="showCheckout()">
                        Jetzt Abonnieren
                    </button>

                    <div class="paywall-login">
                        Bereits Abonnent? <a href="#" onclick="showLogin(); return false;">Hier einloggen</a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Disclaimer Section -->
    <section style="padding: 40px; background: rgba(255, 71, 87, 0.05); border-top: 1px solid rgba(255, 71, 87, 0.2);">
        <div style="max-width: 900px; margin: 0 auto; text-align: center;">
            <h3 style="color: #ff6b7a; font-size: 14px; margin-bottom: 16px; text-transform: uppercase; letter-spacing: 1px;">
                ⚠️ Wichtiger Hinweis
            </h3>
            <p style="color: var(--text-secondary); font-size: 12px; line-height: 1.8; margin-bottom: 12px;">
                <strong style="color: var(--text-primary);">Keine Anlageberatung:</strong> 
                Die auf dieser Website bereitgestellten Trading-Signale stellen keine Anlageberatung, Finanzberatung oder Empfehlung zum Kauf oder Verkauf von Finanzinstrumenten dar. 
                Alle Signale werden durch eine <strong>automatisierte Software</strong> generiert und können fehlerhaft sein.
            </p>
            <p style="color: var(--text-secondary); font-size: 12px; line-height: 1.8; margin-bottom: 12px;">
                <strong style="color: var(--text-primary);">Risikowarnung:</strong> 
                Der Handel mit Finanzinstrumenten ist mit erheblichen Risiken verbunden und kann zum Totalverlust des eingesetzten Kapitals führen. 
                Vergangene Ergebnisse garantieren keine zukünftigen Gewinne. Handeln Sie nur mit Kapital, dessen Verlust Sie verkraften können.
            </p>
            <p style="color: #666; font-size: 11px;">
                Mit der Nutzung dieser Website akzeptieren Sie unsere <a href="agb.html" style="color: var(--accent-green);">AGB</a> und den vollständigen <a href="agb.html#haftung" style="color: var(--accent-green);">Haftungsausschluss</a>.
            </p>
        </div>
    </section>

    <footer class="footer">
        <div style="margin-bottom: 16px;">
            <a href="index.html" style="color: var(--text-secondary); text-decoration: none; margin: 0 12px;">Startseite</a>
            <a href="wolfewaves.html" style="color: var(--text-secondary); text-decoration: none; margin: 0 12px;">Was sind Wolfe Waves?</a>
            <a href="impressum.html" style="color: var(--text-secondary); text-decoration: none; margin: 0 12px;">Impressum</a>
            <a href="datenschutz.html" style="color: var(--text-secondary); text-decoration: none; margin: 0 12px;">Datenschutz</a>
            <a href="agb.html" style="color: var(--text-secondary); text-decoration: none; margin: 0 12px;">AGB</a>
            <a href="widerruf.html" style="color: var(--text-secondary); text-decoration: none; margin: 0 12px;">Widerruf</a>
        </div>
        <div style="color: var(--text-secondary); font-size: 11px;">
            © 2025 wolfewavesignals.com — Trading-Signale für professionelle Händler
        </div>
    </footer>

    <!-- Auth Modal -->
    <div class="modal" id="authModal">
        <div class="auth-card">
            <span class="modal-close" onclick="closeAuthModal()">✕</span>
            <div id="loginForm" class="auth-form">
                <div class="auth-header">
                    <div class="auth-icon">🦊</div>
                    <h2>Willkommen zurück</h2>
                    <p>Melde dich an, um alle Signale zu sehen</p>
                </div>
                <div class="auth-fields">
                    <div class="input-group">
                        <label>E-Mail</label>
                        <input type="email" id="loginEmail" placeholder="deine@email.de">
                    </div>
                    <div class="input-group">
                        <label>Passwort</label>
                        <input type="password" id="loginPassword" placeholder="••••••••">
                    </div>
                </div>
                <div class="auth-error" id="loginError"></div>
                <button class="auth-btn" onclick="handleLogin()">Einloggen</button>
                <div class="auth-footer">
                    <a href="#" onclick="toggleAuthForm('register'); return false;">Neu hier? Registrieren</a>
                </div>
            </div>
            <div id="registerForm" class="auth-form" style="display:none;">
                <div class="auth-header">
                    <div class="auth-icon">🏆</div>
                    <h2>Account erstellen</h2>
                    <p>Starte mit deinem kostenlosen Account</p>
                </div>
                <div class="auth-fields">
                    <div class="input-group">
                        <label>E-Mail</label>
                        <input type="email" id="registerEmail" placeholder="deine@email.de">
                    </div>
                    <div class="input-group">
                        <label>Passwort</label>
                        <input type="password" id="registerPassword" placeholder="Mind. 6 Zeichen">
                    </div>
                </div>
                <div class="auth-error" id="registerError"></div>
                <button class="auth-btn" onclick="handleRegister()">Kostenlos registrieren</button>
                <div class="auth-footer">
                    <a href="#" onclick="toggleAuthForm('login'); return false;">Bereits registriert? Einloggen</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Image Modal - MIT ECHTEN PFEILEN -->
    <div class="modal" id="imageModal">
        <span class="modal-close" onclick="closeModal()">✕</span>
        <div class="image-slider-container">
            <!-- Navigation Buttons - ECHTE PFEILE -->
            <button class="slider-nav slider-prev" onclick="prevImage()" id="sliderPrev">←</button>
            <button class="slider-nav slider-next" onclick="nextImage()" id="sliderNext">→</button>
            
            <!-- Main Image -->
            <img src="" alt="Chart" id="modalImage">
            
            <!-- Image Info & Counter -->
            <div class="slider-info" id="sliderInfo">
                <span id="sliderCounter">1 / 1</span>
                <span id="sliderDate"></span>
            </div>
            
            <!-- Thumbnail Strip (wenn mehrere Bilder) -->
            <div class="slider-thumbnails" id="sliderThumbnails"></div>
        </div>
    </div>

    <!-- Admin Delete Modal -->
    <div class="admin-modal" id="deleteModal">
        <div class="admin-modal-card">
            <div class="admin-modal-header">
                <span style="font-size: 28px;">🗑️</span>
                <h3>Signal löschen</h3>
            </div>
            <div class="admin-modal-body">
                <p>Bist du sicher, dass du dieses Signal löschen möchtest?</p>
                <div style="background: var(--bg-primary); padding: 12px; border-radius: 8px;">
                    <strong id="deleteSignalInfo"></strong>
                </div>
                <p style="color: var(--accent-red); margin-top: 12px; font-size: 13px;">
                    ⚠️ Diese Aktion kann nicht rückgängig gemacht werden!
                </p>
            </div>
            <div class="admin-modal-footer">
                <button class="admin-modal-btn admin-modal-btn-cancel" onclick="closeDeleteModal()">Abbrechen</button>
                <button class="admin-modal-btn admin-modal-btn-danger" onclick="confirmDelete()">Löschen</button>
            </div>
        </div>
    </div>

    <!-- Admin Success Modal -->
    <div class="admin-modal" id="successModal">
        <div class="admin-modal-card">
            <div class="admin-modal-header">
                <span style="font-size: 28px;">🏆</span>
                <h3>Zu Success hinzufügen</h3>
            </div>
            <div class="admin-modal-body">
                <p>Markiere dieses Signal als abgeschlossen:</p>
                <div style="background: var(--bg-primary); padding: 12px; border-radius: 8px; margin-bottom: 16px;">
                    <strong id="successSignalInfo"></strong>
                </div>
                <div class="admin-form-group">
                    <label>Ergebnis auswählen:</label>
                    <select id="successResult">
                        <option value="TP3_HIT">🏆 TP3 erreicht (Volltreffer)</option>
                        <option value="TP2_HIT">✅ TP2 erreicht</option>
                        <option value="TP1_HIT">📈 TP1 erreicht</option>
                        <option value="SL_HIT">🛑 Stop Loss getroffen</option>
                        <option value="EXPIRED">⏰ Abgelaufen (kein Ziel)</option>
                    </select>
                </div>
            </div>
            <div class="admin-modal-footer">
                <button class="admin-modal-btn admin-modal-btn-cancel" onclick="closeSuccessModal()">Abbrechen</button>
                <button class="admin-modal-btn admin-modal-btn-success" onclick="confirmSuccess()">Speichern</button>
            </div>
        </div>
    </div>

    <!-- Admin Badge -->
    <div class="admin-badge" id="adminBadge">
        🛡️ Admin-Modus aktiv
    </div>


    <script>
        const SUPABASE_URL = 'https://ufqglmqiuyasszieprsr.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVmcWdsbXFpdXlhc3N6aWVwcnNyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjgzODAzNDQsImV4cCI6MjA4Mzk1NjM0NH0.F2pfyfNNSr8hqZYowjDIbXmek-GvmpyZRwIEUaC3h-4';
        const STORAGE_URL = `${SUPABASE_URL}/storage/v1/object/public/signals`;

        let allSignals = [];
        let completedSignals = [];
        let currentUser = null;
        let isSubscribed = false;
        let isAdmin = false;
        let currentTab = 'all';

        // Zoom-Steuerung
        let gridColumns = 4;
        const MIN_COLUMNS = 1;
        const MAX_COLUMNS = 6;

        function updateGridZoom() {
            document.documentElement.style.setProperty('--grid-columns', gridColumns);
            document.getElementById('zoomIndicator').textContent = gridColumns;
            localStorage.setItem('gridZoom', gridColumns);
            
            // Fullscreen-Modus bei 1 Spalte
            const grid = document.getElementById('previewGrid');
            if (gridColumns === 1) {
                grid.classList.add('fullscreen-mode');
            } else {
                grid.classList.remove('fullscreen-mode');
            }
        }

        function zoomIn() {
            if (gridColumns > MIN_COLUMNS) {
                gridColumns--;
                updateGridZoom();
            }
        }

        function zoomOut() {
            if (gridColumns < MAX_COLUMNS) {
                gridColumns++;
                updateGridZoom();
            }
        }

        function zoomFull() {
            gridColumns = 1;
            updateGridZoom();
        }

        // Zoom aus localStorage laden
        const savedZoom = localStorage.getItem('gridZoom');
        if (savedZoom) {
            gridColumns = parseInt(savedZoom);
            document.documentElement.style.setProperty('--grid-columns', gridColumns);
        }

        const PREVIEW_MARKETS = ['NASDAQ', 'FOREX', 'DAX'];

        // ==================== INIT ====================
        async function init() {
            updateGridZoom();
            await checkSession();
            await fetchSignals();
            await fetchCompletedSignals();
            updateStats();
            renderSignals();
            setupEventListeners();
        }

        // ==================== AUTH ====================
        async function checkSession() {
            try {
                const response = await fetch(`${SUPABASE_URL}/auth/v1/user`, {
                    headers: {
                        'apikey': SUPABASE_KEY,
                        'Authorization': `Bearer ${getAccessToken()}`
                    }
                });
                
                if (response.ok) {
                    const user = await response.json();
                    if (user && user.id) {
                        currentUser = user;
                        await checkSubscription();
                        await checkAdminStatus();
                        updateUIForUser();
                        return true;
                    }
                }
            } catch (e) {
                console.log('No active session');
            }
            
            currentUser = null;
            updateUIForGuest();
            return false;
        }

        async function checkSubscription() {
            try {
                const response = await fetch(
                    `${SUPABASE_URL}/rest/v1/subscriptions?user_id=eq.${currentUser.id}&status=eq.active&select=*`,
                    {
                        headers: {
                            'apikey': SUPABASE_KEY,
                            'Authorization': `Bearer ${getAccessToken()}`
                        }
                    }
                );
                
                if (response.ok) {
                    const subs = await response.json();
                    isSubscribed = subs.length > 0;
                }
            } catch (e) {
                isSubscribed = false;
            }
        }

        async function checkAdminStatus() {
            try {
                const response = await fetch(
                    `${SUPABASE_URL}/rest/v1/admins?user_id=eq.${currentUser.id}&select=*`,
                    {
                        headers: {
                            'apikey': SUPABASE_KEY,
                            'Authorization': `Bearer ${getAccessToken()}`
                        }
                    }
                );
                
                if (response.ok) {
                    const admins = await response.json();
                    isAdmin = admins.length > 0;
                }
            } catch (e) {
                isAdmin = false;
            }
        }

        function getAccessToken() {
            return localStorage.getItem('sb_access_token') || '';
        }

        function saveTokens(access, refresh) {
            localStorage.setItem('sb_access_token', access);
            localStorage.setItem('sb_refresh_token', refresh);
        }

        function clearTokens() {
            localStorage.removeItem('sb_access_token');
            localStorage.removeItem('sb_refresh_token');
        }

        async function handleLogin() {
            const email = document.getElementById('loginEmail').value.trim();
            const password = document.getElementById('loginPassword').value;
            const errorEl = document.getElementById('loginError');
            
            errorEl.textContent = '';
            
            if (!email || !password) {
                errorEl.textContent = 'Bitte E-Mail und Passwort eingeben';
                return;
            }
            
            try {
                const response = await fetch(`${SUPABASE_URL}/auth/v1/token?grant_type=password`, {
                    method: 'POST',
                    headers: {
                        'apikey': SUPABASE_KEY,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ email, password })
                });
                
                const data = await response.json();
                
                if (!response.ok) {
                    throw new Error(data.error_description || 'Login fehlgeschlagen');
                }
                
                saveTokens(data.access_token, data.refresh_token);
                currentUser = data.user;
                
                await checkSubscription();
                await checkAdminStatus();
                updateUIForUser();
                closeAuthModal();
                renderSignals();
                
            } catch (error) {
                errorEl.textContent = error.message === 'Invalid login credentials' 
                    ? 'Falsche E-Mail oder Passwort' 
                    : error.message;
            }
        }

        async function handleRegister() {
            const email = document.getElementById('registerEmail').value.trim();
            const password = document.getElementById('registerPassword').value;
            const errorEl = document.getElementById('registerError');
            
            errorEl.textContent = '';
            
            if (!email || !password) {
                errorEl.textContent = 'Bitte alle Felder ausfüllen';
                return;
            }
            
            if (password.length < 6) {
                errorEl.textContent = 'Passwort muss mindestens 6 Zeichen haben';
                return;
            }
            
            try {
                const response = await fetch(`${SUPABASE_URL}/auth/v1/signup`, {
                    method: 'POST',
                    headers: {
                        'apikey': SUPABASE_KEY,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ email, password })
                });
                
                const data = await response.json();
                
                if (!response.ok) {
                    throw new Error(data.error_description || 'Registrierung fehlgeschlagen');
                }
                
                if (data.access_token) {
                    saveTokens(data.access_token, data.refresh_token);
                    currentUser = data.user;
                    await checkSubscription();
                    updateUIForUser();
                    closeAuthModal();
                    renderSignals();
                } else {
                    errorEl.style.color = 'var(--accent-green)';
                    errorEl.textContent = '✔ Bestätigungs-E-Mail gesendet!';
                }
                
            } catch (error) {
                errorEl.textContent = error.message;
            }
        }

        function handleLogout() {
            clearTokens();
            currentUser = null;
            isSubscribed = false;
            isAdmin = false;
            currentTab = 'all';
            updateUIForGuest();
            renderSignals();
        }

        // ==================== UI UPDATES ====================
        function updateUIForUser() {
            const headerRight = document.querySelector('.header-right');
            const initial = currentUser.email ? currentUser.email.charAt(0).toUpperCase() : '?';
            
            let statusText = 'Free Account';
            if (isAdmin) statusText = '🛡️ Admin';
            else if (isSubscribed) statusText = '✔ Premium';
            
            headerRight.innerHTML = `
                <div class="live-indicator">
                    <div class="live-dot"></div>
                    <span>LIVE</span>
                </div>
                <div class="user-menu-container">
                    <div class="user-menu-trigger" onclick="toggleUserMenu()">
                        <div class="user-avatar">${initial}</div>
                        <div class="user-info">
                            <span class="user-email">${currentUser.email}</span>
                            <span class="user-status">${statusText}</span>
                        </div>
                    </div>
                    <div class="user-dropdown">
                        ${isSubscribed ? '<div class="dropdown-item" onclick="manageSubscription()">💳 Abo verwalten</div>' : '<div class="dropdown-item" onclick="showCheckout()">⭐ Premium werden</div>'}
                        <div class="dropdown-item" onclick="handleLogout()">🚪 Ausloggen</div>
                    </div>
                </div>
            `;
            
            if (isSubscribed || isAdmin) {
                document.getElementById('tabsSection').classList.add('visible');
                document.getElementById('premiumSection').style.display = 'none';
                
                document.getElementById('previewHeader').innerHTML = `
                    <div class="section-title">
                        🦊 Alle Signale
                        <span class="section-badge" style="background: ${isAdmin ? 'var(--accent-gold)' : 'var(--accent-green)'};">${isAdmin ? 'Admin' : 'Premium'}</span>
                    </div>
                    <div class="section-subtitle">— Du hast Zugriff auf alle Signale</div>
                `;
            }
            
            if (isAdmin) {
                document.getElementById('adminBadge').classList.add('visible');
            } else {
                document.getElementById('adminBadge').classList.remove('visible');
            }
        }

        function updateUIForGuest() {
            const headerRight = document.querySelector('.header-right');
            headerRight.innerHTML = `
                <div class="live-indicator">
                    <div class="live-dot"></div>
                    <span>LIVE</span>
                </div>
                <button class="btn btn-outline" onclick="showLogin()">Login</button>
                <button class="btn btn-primary" onclick="showCheckout()">Abo 19,90€/Monat</button>
            `;
            
            document.getElementById('tabsSection').classList.remove('visible');
            document.getElementById('premiumSection').style.display = 'block';
            document.getElementById('successStatsBar').classList.remove('visible');
            document.getElementById('adminBadge').classList.remove('visible');
            
            document.getElementById('previewHeader').innerHTML = `
                <div class="section-title">
                    🎁 Kostenlose Vorschau
                    <span class="section-badge">Gratis</span>
                </div>
                <div class="section-subtitle">— Sieh dir 3 echte Signale an</div>
            `;
        }

        function toggleUserMenu() {
            document.querySelector('.user-menu-container').classList.toggle('open');
        }

        // ==================== FETCH DATA ====================
        async function fetchSignals() {
            try {
                const response = await fetch(`${SUPABASE_URL}/rest/v1/signals?select=*&status=in.(pending,active)&order=created_at.desc`, {
                    headers: {
                        'apikey': SUPABASE_KEY,
                        'Authorization': `Bearer ${SUPABASE_KEY}`
                    }
                });
                
                if (!response.ok) throw new Error('Failed to fetch');
                allSignals = await response.json();
                
            } catch (error) {
                console.error('Error:', error);
            }
        }

        async function fetchCompletedSignals() {
            try {
                const response = await fetch(`${SUPABASE_URL}/rest/v1/completed_signals?select=*&order=created_at.desc`, {
                    headers: {
                        'apikey': SUPABASE_KEY,
                        'Authorization': `Bearer ${SUPABASE_KEY}`
                    }
                });
                
                if (response.ok) {
                    completedSignals = await response.json();
                }
            } catch (e) {
                console.log('No completed_signals yet');
                completedSignals = [];
            }
        }

        // ==================== STATS ====================
        function updateStats() {
            const now = new Date();
            const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
            const twoHoursAgo = new Date(now - 2 * 60 * 60 * 1000);
            
            document.getElementById('totalSignals').textContent = allSignals.length;
            
            const successTotal = completedSignals.filter(s => s.result_folder === 'success').length;
            document.getElementById('successCount').textContent = successTotal;
            
            const todaySignals = allSignals.filter(s => new Date(s.created_at) >= today);
            document.getElementById('todayCount').textContent = todaySignals.length;
            
            const newSignals = allSignals.filter(s => new Date(s.created_at) >= twoHoursAgo);
            document.getElementById('newCount').textContent = newSignals.length;
            
            document.getElementById('successTabCount').textContent = completedSignals.length;
            
            const premiumCount = Math.max(0, allSignals.length - 3);
            document.getElementById('premiumCount').textContent = `+${premiumCount} weitere Signale`;
            
            updateSuccessStats();
        }

        function updateSuccessStats() {
            const total = completedSignals.length;
            const tp3 = completedSignals.filter(s => s.tp3_hit).length;
            const tp2 = completedSignals.filter(s => s.tp2_hit && !s.tp3_hit).length;
            const tp1 = completedSignals.filter(s => s.tp1_hit && !s.tp2_hit && !s.tp3_hit).length;
            const sl = completedSignals.filter(s => s.sl_hit && !s.tp1_hit).length;
            const success = completedSignals.filter(s => s.result_folder === 'success').length;
            const rate = total > 0 ? ((success / total) * 100).toFixed(1) : 0;
            
            document.getElementById('successRateValue').textContent = rate + '%';
            document.getElementById('tp3Count').textContent = tp3;
            document.getElementById('tp2Count').textContent = tp2;
            document.getElementById('tp1Count').textContent = tp1;
            document.getElementById('slCount').textContent = sl;
            
            const headerValue = document.getElementById('headerSuccessValue');
            if(headerValue) headerValue.textContent = rate + '%';
        }

        // ==================== RENDERING ====================
        function renderSignals() {
            const grid = document.getElementById('previewGrid');
            const isPremium = currentUser && (isSubscribed || isAdmin);
            
            const statsBar = document.getElementById('successStatsBar');
            if (currentTab === 'success' && isPremium) {
                statsBar.classList.add('visible');
            } else {
                statsBar.classList.remove('visible');
            }
            
            if (!isPremium) {
                const preview = getPreviewSignals();
                grid.innerHTML = preview.map(s => renderSignalCard(s, true, false)).join('');
                renderLockedSignals();
                return;
            }
            
            let signals = [];
            
            if (currentTab === 'success') {
                signals = getFilteredCompletedSignals();
                const searchTerm = document.getElementById('searchSymbol').value.trim();
                grid.innerHTML = signals.length > 0 
                    ? signals.map(s => renderCompletedSignalCard(s)).join('')
                    : `<div class="no-results">
                        <div class="no-results-icon">🔍</div>
                        <h3>${searchTerm ? `Keine Ergebnisse für "${searchTerm}"` : 'Keine abgeschlossenen Trades'}</h3>
                        <p>${searchTerm ? 'Versuche einen anderen Suchbegriff' : 'Noch keine Trades abgeschlossen'}</p>
                      </div>`;
            } else {
                signals = getFilteredSignals();
                const searchTerm = document.getElementById('searchSymbol').value.trim();
                grid.innerHTML = signals.length > 0
                    ? signals.map(s => renderSignalCard(s, true, false)).join('')
                    : `<div class="no-results">
                        <div class="no-results-icon">🔍</div>
                        <h3>${searchTerm ? `Keine Signale für "${searchTerm}"` : 'Keine Signale gefunden'}</h3>
                        <p>${searchTerm ? 'Versuche einen anderen Suchbegriff oder ändere die Filter' : 'Ändere die Filter um mehr Signale zu sehen'}</p>
                      </div>`;
            }
            
            const header = document.getElementById('previewHeader');
            const searchTerm = document.getElementById('searchSymbol').value.trim();
            
            if (currentTab === 'success') {
                header.innerHTML = `
                    <div class="section-title">
                        🏆 Abgeschlossene Trades
                        <span class="section-badge" style="background: var(--accent-gold);">Success</span>
                    </div>
                    <div class="section-subtitle">— ${signals.length} Trades${searchTerm ? ` für "${searchTerm}"` : ''}</div>
                `;
            } else {
                header.innerHTML = `
                    <div class="section-title">
                        🦊 ${currentTab === 'all' ? 'Alle' : currentTab === 'new' ? 'Neue' : currentTab.charAt(0).toUpperCase() + currentTab.slice(1)} Signale
                        <span class="section-badge" style="background: ${isAdmin ? 'var(--accent-gold)' : 'var(--accent-green)'};">${isAdmin ? 'Admin' : 'Premium'}</span>
                    </div>
                    <div class="section-subtitle">— ${signals.length} Signale${searchTerm ? ` für "${searchTerm}"` : ''}</div>
                `;
            }
        }

        function getPreviewSignals() {
            const preview = [];
            for (const market of PREVIEW_MARKETS) {
                const signal = allSignals.find(s => s.market === market && !preview.some(p => p.id === s.id));
                if (signal) preview.push(signal);
            }
            while (preview.length < 3 && preview.length < allSignals.length) {
                const signal = allSignals.find(s => !preview.some(p => p.id === s.id));
                if (signal) preview.push(signal);
                else break;
            }
            return preview;
        }

        function getFilteredSignals() {
            const market = document.getElementById('filterMarket').value;
            const timeframe = document.getElementById('filterTimeframe').value;
            const searchTerm = document.getElementById('searchSymbol').value.toLowerCase().trim();
            const now = new Date();
            const twoHoursAgo = new Date(now - 2 * 60 * 60 * 1000);
            
            let filtered = [...allSignals];
            
            if (currentTab === 'new') {
                filtered = filtered.filter(s => new Date(s.created_at) >= twoHoursAgo);
            } else if (currentTab === 'bullish') {
                filtered = filtered.filter(s => s.direction === 'BULLISH');
            } else if (currentTab === 'bearish') {
                filtered = filtered.filter(s => s.direction === 'BEARISH');
            }
            
            if (market) filtered = filtered.filter(s => s.market === market);
            if (timeframe) filtered = filtered.filter(s => s.timeframe === timeframe);
            
            if (searchTerm) {
                filtered = filtered.filter(s => 
                    (s.symbol && s.symbol.toLowerCase().includes(searchTerm)) ||
                    (s.symbol_name && s.symbol_name.toLowerCase().includes(searchTerm))
                );
            }
            
            return filtered;
        }

        function getFilteredCompletedSignals() {
            const market = document.getElementById('filterMarket').value;
            const timeframe = document.getElementById('filterTimeframe').value;
            const searchTerm = document.getElementById('searchSymbol').value.toLowerCase().trim();
            
            let filtered = [...completedSignals];
            
            if (market) filtered = filtered.filter(s => s.market === market);
            if (timeframe) filtered = filtered.filter(s => s.timeframe === timeframe);
            
            if (searchTerm) {
                filtered = filtered.filter(s => 
                    (s.symbol && s.symbol.toLowerCase().includes(searchTerm))
                );
            }
            
            return filtered;
        }

        function renderLockedSignals() {
            const grid = document.getElementById('lockedGrid');
            const previewIds = new Set(getPreviewSignals().map(s => s.id));
            const locked = allSignals.filter(s => !previewIds.has(s.id)).slice(0, 6);
            
            grid.innerHTML = locked.map(s => renderSignalCard(s, false, false)).join('');
        }

        // ==================== SIGNAL CARD MIT FARBKODIERUNG ====================
        function renderSignalCard(signal, isVisible, isPreview) {
            const imageUrl = signal.image_path?.startsWith('http') ? signal.image_path : `${STORAGE_URL}/${signal.image_path}`;
            const isBullish = signal.direction === 'BULLISH';
            const isNew = isNewSignal(signal.created_at);
            
            let badge = '';
            if (isPreview) {
                badge = '<div class="preview-badge">Vorschau</div>';
            } else if (isNew && isVisible) {
                badge = '<div class="new-badge">NEU</div>';
            }
            
            const adminControls = isAdmin && isVisible ? `
                <div class="admin-controls${gridColumns === 1 ? ' always-visible' : ''}">
                    <button class="admin-btn admin-btn-success" data-success-signal="${signal.id}" title="Zu Success hinzufügen">✔</button>
                    <button class="admin-btn admin-btn-delete" data-delete-signal="${signal.id}" title="Signal löschen">×</button>
                </div>
            ` : '';
            
            return `
                <div class="signal-card ${isNew ? 'is-new' : ''}" onclick="openModal('${imageUrl}', '${signal.wedge_id || ''}')">
                    ${badge}
                    ${adminControls}
                    <div class="signal-image-container">
                        <img class="signal-image" src="${imageUrl}" alt="${signal.symbol}" loading="lazy">
                        <span class="signal-badge ${isBullish ? 'badge-bullish' : 'badge-bearish'}">${signal.direction}</span>
                        <div class="signal-tags">
                            <span class="signal-tag">${signal.market}</span>
                            <span class="signal-tag">${signal.timeframe}</span>
                        </div>
                    </div>
                    <div class="signal-info">
                        <div class="signal-header">
                            <div>
                                <div class="signal-title">${signal.symbol_name || signal.symbol}</div>
                                <div class="signal-symbol">${signal.symbol}</div>
                            </div>
                            <div class="signal-time">
                                <div class="signal-date">${formatDate(signal.created_at)}</div>
                                <div class="signal-ago">${getTimeAgo(signal.created_at)}</div>
                            </div>
                        </div>
                        <div class="price-grid">
                            <div class="price-item"><div class="price-label entry">Entry</div><div class="price-value entry">${formatPrice(signal.entry)}</div></div>
                            <div class="price-item"><div class="price-label stop">Stop</div><div class="price-value stop">${formatPrice(signal.sl)}</div></div>
                            <div class="price-item"><div class="price-label tp1">TP1</div><div class="price-value tp1">${formatPrice(signal.tp1)}</div></div>
                            <div class="price-item"><div class="price-label tp2">TP2</div><div class="price-value tp2">${formatPrice(signal.tp2)}</div></div>
                            <div class="price-item"><div class="price-label tp3">TP3</div><div class="price-value tp3">${formatPrice(signal.tp3)}</div></div>
                        </div>
                        <div class="rr-badge">R/R <span>1:${signal.rr?.toFixed(1) || '—'}</span></div>
                    </div>
                </div>
            `;
        }

        function renderCompletedSignalCard(signal) {
            const imageUrl = signal.original_path || '';
            const isBullish = signal.direction === 'BULLISH';
            
            let resultClass = 'sl';
            let resultBadge = '🛑 SL';
            let cardClass = 'is-failed';
            
            if (signal.tp3_hit) {
                resultClass = 'tp3';
                resultBadge = '🏆 TP3';
                cardClass = 'is-success tp3';
            } else if (signal.tp2_hit) {
                resultClass = 'tp2';
                resultBadge = '✅ TP2';
                cardClass = 'is-success tp2';
            } else if (signal.tp1_hit) {
                resultClass = 'tp1';
                resultBadge = '📈 TP1';
                cardClass = 'is-success tp1';
            }
            
            const adminControls = isAdmin ? `
                <div class="admin-controls" style="right: auto; left: 12px; top: 48px;">
                    <button class="admin-btn admin-btn-delete" data-delete-completed="${signal.id}" title="Aus Success entfernen">×</button>
                </div>
            ` : '';
            
            return `
                <div class="signal-card ${cardClass}" onclick="openModal('${imageUrl}', '${signal.wedge_id || ''}')">
                    <div class="result-badge ${resultClass}">${resultBadge}</div>
                    ${adminControls}
                    <div class="signal-image-container">
                        ${imageUrl ? `<img class="signal-image" src="${imageUrl}" alt="${signal.symbol}" loading="lazy">` : '<div class="placeholder-image" style="height:100%;display:flex;align-items:center;justify-content:center;font-size:48px;opacity:0.3;">📈</div>'}
                        <span class="signal-badge ${isBullish ? 'badge-bullish' : 'badge-bearish'}">${signal.direction}</span>
                        <div class="signal-tags">
                            <span class="signal-tag">${signal.market}</span>
                            <span class="signal-tag">${signal.timeframe}</span>
                        </div>
                    </div>
                    <div class="signal-info">
                        <div class="signal-header">
                            <div>
                                <div class="signal-title">${signal.symbol}</div>
                                <div class="signal-symbol">${signal.wedge_id}</div>
                            </div>
                            <div class="signal-time">
                                <div class="signal-date">${formatDate(signal.created_at)}</div>
                                <div class="signal-ago">${getTimeAgo(signal.created_at)}</div>
                            </div>
                        </div>
                        <div class="price-grid" style="grid-template-columns: repeat(4, 1fr);">
                            <div class="price-item">
                                <div class="price-label tp1">TP1</div>
                                <div class="price-value" style="color: ${signal.tp1_hit ? 'var(--accent-lightgreen)' : 'var(--text-secondary)'}">
                                    ${signal.tp1_hit ? '✔' : '—'}
                                </div>
                            </div>
                            <div class="price-item">
                                <div class="price-label tp2">TP2</div>
                                <div class="price-value" style="color: ${signal.tp2_hit ? 'var(--accent-green)' : 'var(--text-secondary)'}">
                                    ${signal.tp2_hit ? '✔' : '—'}
                                </div>
                            </div>
                            <div class="price-item">
                                <div class="price-label tp3">TP3</div>
                                <div class="price-value" style="color: ${signal.tp3_hit ? 'var(--accent-gold)' : 'var(--text-secondary)'}">
                                    ${signal.tp3_hit ? '🏆' : '—'}
                                </div>
                            </div>
                            <div class="price-item">
                                <div class="price-label stop">SL</div>
                                <div class="price-value" style="color: ${signal.sl_hit ? 'var(--accent-red)' : 'var(--text-secondary)'}">
                                    ${signal.sl_hit ? '✗' : '—'}
                                </div>
                            </div>
                        </div>
                        <div class="rr-badge" style="background: ${signal.result_folder === 'success' ? 'rgba(0,255,136,0.1)' : 'rgba(255,71,87,0.1)'}">
                            Ergebnis: <span style="color: ${signal.result_folder === 'success' ? 'var(--accent-green)' : 'var(--accent-red)'}">${signal.result_folder === 'success' ? 'Gewinn' : 'Verlust'}</span>
                        </div>
                    </div>
                </div>
            `;
        }

        // ==================== HELPERS ====================
        function isNewSignal(createdAt) {
            const now = new Date();
            const signalTime = new Date(createdAt);
            return (now - signalTime) < 2 * 60 * 60 * 1000;
        }

        function getTimeAgo(createdAt) {
            const now = new Date();
            const date = new Date(createdAt);
            const diffMs = now - date;
            const diffMins = Math.floor(diffMs / 60000);
            const diffHours = Math.floor(diffMs / 3600000);
            const diffDays = Math.floor(diffMs / 86400000);
            
            if (diffMins < 60) return `vor ${diffMins} Min`;
            if (diffHours < 24) return `vor ${diffHours} Std`;
            return `vor ${diffDays} Tag${diffDays > 1 ? 'en' : ''}`;
        }

        function formatPrice(price) {
            return price ? parseFloat(price).toFixed(2) : '—';
        }

        function formatDate(dateStr) {
            return new Date(dateStr).toLocaleDateString('de-DE');
        }

        // ==================== EVENT LISTENERS ====================
        function setupEventListeners() {
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    currentTab = tab.dataset.tab;
                    renderSignals();
                });
            });
            
            document.getElementById('filterMarket').addEventListener('change', renderSignals);
            document.getElementById('filterTimeframe').addEventListener('change', renderSignals);
            
            let searchTimeout;
            document.getElementById('searchSymbol').addEventListener('input', () => {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(renderSignals, 300);
            });
            
            document.getElementById('searchSymbol').addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    e.target.value = '';
                    renderSignals();
                }
            });
            
            document.addEventListener('click', (e) => {
                const menu = document.querySelector('.user-menu-container');
                if (menu && !menu.contains(e.target)) {
                    menu.classList.remove('open');
                }
                
                if (e.target.matches('[data-delete-signal]')) {
                    e.stopPropagation();
                    const signalId = e.target.getAttribute('data-delete-signal');
                    showDeleteModal(signalId);
                }
                
                if (e.target.matches('[data-delete-completed]')) {
                    e.stopPropagation();
                    const signalId = e.target.getAttribute('data-delete-completed');
                    showDeleteCompletedModal(signalId);
                }
                
                if (e.target.matches('[data-success-signal]')) {
                    e.stopPropagation();
                    const signalId = e.target.getAttribute('data-success-signal');
                    showSuccessModal(signalId);
                }
            });
        }

        // ==================== MODALS ====================
        function showLogin() {
            toggleAuthForm('login');
            document.getElementById('authModal').classList.add('active');
        }

        function toggleAuthForm(form) {
            document.getElementById('loginForm').style.display = form === 'login' ? 'block' : 'none';
            document.getElementById('registerForm').style.display = form === 'register' ? 'block' : 'none';
        }

        function closeAuthModal() {
            document.getElementById('authModal').classList.remove('active');
        }

        // ==================== IMAGE SLIDER ====================
        let sliderImages = [];
        let sliderCurrentIndex = 0;
        let currentWedgeId = null;

        async function openModal(imageUrl, wedgeId = null) {
            if (!imageUrl) return;
            
            currentWedgeId = wedgeId;
            sliderImages = [{ url: imageUrl, scanned_at: null }];
            sliderCurrentIndex = 0;
            
            updateSliderDisplay();
            document.getElementById('imageModal').classList.add('active');
            
            if (wedgeId) {
                await loadImageHistory(wedgeId, imageUrl);
            }
        }

        async function loadImageHistory(wedgeId, currentImageUrl) {
            try {
                const response = await fetch(
                    `${SUPABASE_URL}/rest/v1/signal_images?wedge_id=eq.${wedgeId}&select=image_url,scanned_at,version&order=scanned_at.desc`,
                    {
                        headers: {
                            'apikey': SUPABASE_KEY,
                            'Authorization': `Bearer ${SUPABASE_KEY}`
                        }
                    }
                );
                
                if (!response.ok) throw new Error('HTTP ' + response.status);
                
                const data = await response.json();
                
                if (data && data.length > 0) {
                    sliderImages = data.map(img => ({
                        url: img.image_url,
                        scanned_at: img.scanned_at
                    }));
                    
                    if (sliderImages[0].url !== currentImageUrl) {
                        sliderImages.unshift({ url: currentImageUrl, scanned_at: new Date().toISOString() });
                    }
                    
                    sliderCurrentIndex = 0;
                    updateSliderDisplay();
                    renderThumbnails();
                }
            } catch (err) {
                console.log('Keine Bild-Historie gefunden:', err.message);
            }
        }

        function updateSliderDisplay() {
            const img = sliderImages[sliderCurrentIndex];
            document.getElementById('modalImage').src = img.url;
            
            const counter = document.getElementById('sliderCounter');
            counter.textContent = `${sliderCurrentIndex + 1} / ${sliderImages.length}`;
            
            const dateEl = document.getElementById('sliderDate');
            if (img.scanned_at) {
                const date = new Date(img.scanned_at);
                dateEl.textContent = date.toLocaleDateString('de-DE') + ' ' + date.toLocaleTimeString('de-DE', { hour: '2-digit', minute: '2-digit' });
            } else {
                dateEl.textContent = 'Aktuell';
            }
            
            const prevBtn = document.getElementById('sliderPrev');
            const nextBtn = document.getElementById('sliderNext');
            
            if (sliderImages.length <= 1) {
                prevBtn.classList.add('hidden');
                nextBtn.classList.add('hidden');
            } else {
                prevBtn.classList.remove('hidden');
                nextBtn.classList.remove('hidden');
                prevBtn.disabled = sliderCurrentIndex === 0;
                nextBtn.disabled = sliderCurrentIndex === sliderImages.length - 1;
            }
            
            document.querySelectorAll('.slider-thumb').forEach((thumb, i) => {
                thumb.classList.toggle('active', i === sliderCurrentIndex);
            });
        }

        function renderThumbnails() {
            const container = document.getElementById('sliderThumbnails');
            
            if (sliderImages.length <= 1) {
                container.innerHTML = '';
                return;
            }
            
            container.innerHTML = sliderImages.map((img, i) => `
                <img src="${img.url}" 
                     class="slider-thumb ${i === sliderCurrentIndex ? 'active' : ''}" 
                     onclick="goToImage(${i})"
                     alt="Scan ${i + 1}">
            `).join('');
        }

        function prevImage() {
            if (sliderCurrentIndex > 0) {
                sliderCurrentIndex--;
                updateSliderDisplay();
            }
        }

        function nextImage() {
            if (sliderCurrentIndex < sliderImages.length - 1) {
                sliderCurrentIndex++;
                updateSliderDisplay();
            }
        }

        function goToImage(index) {
            sliderCurrentIndex = index;
            updateSliderDisplay();
        }

        function closeModal() {
            document.getElementById('imageModal').classList.remove('active');
            sliderImages = [];
            sliderCurrentIndex = 0;
            currentWedgeId = null;
            document.getElementById('sliderThumbnails').innerHTML = '';
        }

        document.addEventListener('keydown', (e) => {
            if (!document.getElementById('imageModal').classList.contains('active')) return;
            
            if (e.key === 'ArrowLeft') prevImage();
            if (e.key === 'ArrowRight') nextImage();
            if (e.key === 'Escape') closeModal();
        });

        // Checkout Modal Functions
        function showCheckout() {
            if (!currentUser) {
                showLogin();
                return;
            }
            // Reset both checkboxes
            document.getElementById('agbCheckbox').checked = false;
            document.getElementById('widerrufCheckbox').checked = false;
            document.getElementById('agbCheckboxWrapper').classList.remove('checked');
            document.getElementById('widerrufCheckboxWrapper').classList.remove('checked');
            document.getElementById('btnCheckoutConfirm').classList.remove('enabled');
            // Show modal
            document.getElementById('checkoutModal').classList.add('active');
        }

        function toggleAgbConsent() {
            const checkbox = document.getElementById('agbCheckbox');
            checkbox.checked = !checkbox.checked;
            document.getElementById('agbCheckboxWrapper').classList.toggle('checked', checkbox.checked);
            updateCheckoutButton();
        }

        function toggleWiderrufConsent() {
            const checkbox = document.getElementById('widerrufCheckbox');
            checkbox.checked = !checkbox.checked;
            document.getElementById('widerrufCheckboxWrapper').classList.toggle('checked', checkbox.checked);
            updateCheckoutButton();
        }

        function updateCheckoutButton() {
            const agb = document.getElementById('agbCheckbox').checked;
            const widerruf = document.getElementById('widerrufCheckbox').checked;
            const btn = document.getElementById('btnCheckoutConfirm');
            
            if (agb && widerruf) {
                btn.classList.add('enabled');
            } else {
                btn.classList.remove('enabled');
            }
        }

        function closeCheckoutModal() {
            document.getElementById('checkoutModal').classList.remove('active');
        }

        function proceedToCheckout() {
            const agb = document.getElementById('agbCheckbox').checked;
            const widerruf = document.getElementById('widerrufCheckbox').checked;
            
            if (!agb || !widerruf) {
                alert('Bitte akzeptiere die AGB und den Widerrufsverzicht, um fortzufahren.');
                return;
            }
            // Close modal and open LemonSqueezy
            closeCheckoutModal();
            window.open(`https://wolfewavesignals.lemonsqueezy.com/checkout/buy/c700c757-aa10-4752-a8ab-ad37d664fa4f?checkout[email]=${currentUser.email}`, '_blank');
            
            // Track conversion
            trackEvent('checkout_started', 'conversion', 'consent_given');
        }

        function manageSubscription() {
            const choice = confirm('Abo verwalten / kündigen?\n\nKlicke OK um eine E-Mail an den Support zu senden.');
            if (choice) {
                window.location.href = 'mailto:walserfly@gmail.com?subject=Abo%20verwalten&body=Hallo,%0A%0Aich%20möchte%20mein%20Abo%20verwalten%2Fkündigen.%0A%0AMeine%20E-Mail:%20' + encodeURIComponent(currentUser.email);
            }
        }

        // Close checkout modal on outside click
        document.getElementById('checkoutModal').addEventListener('click', e => {
            if (e.target.id === 'checkoutModal') closeCheckoutModal();
        });

        document.getElementById('authModal').addEventListener('click', e => {
            if (e.target.id === 'authModal') closeAuthModal();
        });
        document.getElementById('imageModal').addEventListener('click', e => {
            if (e.target.id === 'imageModal') closeModal();
        });
        document.getElementById('deleteModal').addEventListener('click', e => {
            if (e.target.id === 'deleteModal') closeDeleteModal();
        });
        document.getElementById('successModal').addEventListener('click', e => {
            if (e.target.id === 'successModal') closeSuccessModal();
        });
        document.addEventListener('keydown', e => {
            if (e.key === 'Escape') { closeModal(); closeAuthModal(); closeDeleteModal(); closeSuccessModal(); closeCheckoutModal(); }
        });
        document.getElementById('loginPassword').addEventListener('keydown', e => {
            if (e.key === 'Enter') handleLogin();
        });

        // ==================== ADMIN FUNCTIONS ====================
        let pendingDeleteId = null;
        let pendingDeleteType = null;
        let pendingSuccessId = null;

        function showDeleteModal(signalId) {
            const signal = allSignals.find(s => String(s.id) === String(signalId));
            if (!signal) return;
            
            pendingDeleteId = signalId;
            pendingDeleteType = 'signal';
            document.getElementById('deleteSignalInfo').textContent = `${signal.symbol} - ${signal.market} ${signal.timeframe} (${signal.direction})`;
            document.getElementById('deleteModal').classList.add('active');
        }

        function showDeleteCompletedModal(signalId) {
            const signal = completedSignals.find(s => String(s.id) === String(signalId));
            if (!signal) return;
            
            pendingDeleteId = signalId;
            pendingDeleteType = 'completed';
            document.getElementById('deleteSignalInfo').textContent = `${signal.symbol} - ${signal.market} ${signal.timeframe} (Completed)`;
            document.getElementById('deleteModal').classList.add('active');
        }

        function closeDeleteModal() {
            document.getElementById('deleteModal').classList.remove('active');
            pendingDeleteId = null;
            pendingDeleteType = null;
        }

        async function confirmDelete() {
            if (!pendingDeleteId || !isAdmin) {
                showToast('✗ Keine Berechtigung', 'error');
                return;
            }
            
            const table = pendingDeleteType === 'completed' ? 'completed_signals' : 'signals';
            const deleteId = String(pendingDeleteId);
            
            try {
                const response = await fetch(`${SUPABASE_URL}/rest/v1/${table}?id=eq.${deleteId}`, {
                    method: 'DELETE',
                    headers: {
                        'apikey': SUPABASE_KEY,
                        'Authorization': `Bearer ${getAccessToken()}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                if (response.status === 204 || response.status === 200) {
                    if (pendingDeleteType === 'completed') {
                        completedSignals = completedSignals.filter(s => String(s.id) !== deleteId);
                    } else {
                        allSignals = allSignals.filter(s => String(s.id) !== deleteId);
                    }
                    
                    closeDeleteModal();
                    updateStats();
                    renderSignals();
                    showToast('✔ Signal gelöscht', 'success');
                } else {
                    throw new Error('Delete failed');
                }
            } catch (error) {
                showToast('✗ ' + error.message, 'error');
            }
        }

        function showSuccessModal(signalId) {
            const signal = allSignals.find(s => String(s.id) === String(signalId));
            if (!signal) return;
            
            pendingSuccessId = signalId;
            document.getElementById('successSignalInfo').textContent = `${signal.symbol} - ${signal.market} ${signal.timeframe} (${signal.direction})`;
            document.getElementById('successResult').value = 'TP3_HIT';
            document.getElementById('successModal').classList.add('active');
        }

        function closeSuccessModal() {
            document.getElementById('successModal').classList.remove('active');
            pendingSuccessId = null;
        }

        async function confirmSuccess() {
            if (!pendingSuccessId || !isAdmin) {
                showToast('✗ Keine Berechtigung', 'error');
                return;
            }
            
            const signal = allSignals.find(s => String(s.id) === String(pendingSuccessId));
            if (!signal) return;
            
            const result = document.getElementById('successResult').value;
            
            let tp1_hit = false, tp2_hit = false, tp3_hit = false, sl_hit = false;
            let result_folder = 'failed';
            
            switch (result) {
                case 'TP3_HIT':
                    tp1_hit = tp2_hit = tp3_hit = true;
                    result_folder = 'success';
                    break;
                case 'TP2_HIT':
                    tp1_hit = tp2_hit = true;
                    result_folder = 'success';
                    break;
                case 'TP1_HIT':
                    tp1_hit = true;
                    result_folder = 'success';
                    break;
                case 'SL_HIT':
                    sl_hit = true;
                    result_folder = 'failed';
                    break;
                case 'EXPIRED':
                    result_folder = 'failed';
                    break;
            }
            
            const completedData = {
                wedge_id: signal.wedge_id || `manual_${signal.id}`,
                original_path: signal.image_path?.startsWith('http') ? signal.image_path : `${STORAGE_URL}/${signal.image_path}`,
                result_folder: result_folder,
                result: result,
                symbol: signal.symbol,
                market: signal.market,
                timeframe: signal.timeframe,
                direction: signal.direction,
                tp1_hit: tp1_hit,
                tp2_hit: tp2_hit,
                tp3_hit: tp3_hit,
                sl_hit: sl_hit
            };
            
            try {
                const response = await fetch(`${SUPABASE_URL}/rest/v1/completed_signals`, {
                    method: 'POST',
                    headers: {
                        'apikey': SUPABASE_KEY,
                        'Authorization': `Bearer ${getAccessToken()}`,
                        'Content-Type': 'application/json',
                        'Prefer': 'return=representation'
                    },
                    body: JSON.stringify(completedData)
                });
                
                if (response.ok) {
                    const newCompleted = await response.json();
                    completedSignals.unshift(newCompleted[0]);
                    
                    closeSuccessModal();
                    updateStats();
                    renderSignals();
                    showToast('✔ Zu Success hinzugefügt', 'success');
                } else {
                    throw new Error('Failed');
                }
            } catch (error) {
                showToast('✗ Fehler: ' + error.message, 'error');
            }
        }

        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.style.cssText = `
                position: fixed;
                bottom: 80px;
                right: 20px;
                background: ${type === 'success' ? 'var(--accent-green)' : 'var(--accent-red)'};
                color: ${type === 'success' ? '#000' : '#fff'};
                padding: 12px 24px;
                border-radius: 8px;
                font-weight: 600;
                z-index: 3000;
                animation: slideIn 0.3s ease;
            `;
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        const toastStyle = document.createElement('style');
        toastStyle.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(toastStyle);

        init();
    </script>

    <!-- Checkout Consent Modal -->
    <div class="checkout-modal" id="checkoutModal">
        <div class="checkout-modal-card">
            <div class="checkout-modal-header">
                <div class="icon">🦊</div>
                <h3>WolfeWave Premium</h3>
                <p>Zugriff auf alle Trading-Signale in Echtzeit</p>
            </div>
            
            <div class="checkout-modal-price">
                <span class="amount">19,90€</span>
                <span class="period">/ Monat</span>
            </div>
            
            <div class="consent-checkbox" id="agbCheckboxWrapper" onclick="toggleAgbConsent()">
                <input type="checkbox" id="agbCheckbox">
                <label for="agbCheckbox">
                    Ich habe die <a href="agb.html" target="_blank">AGB</a> und den <a href="agb.html#haftung" target="_blank">Haftungsausschluss</a> gelesen und akzeptiere diese.
                </label>
            </div>
            
            <div class="consent-checkbox" id="widerrufCheckboxWrapper" onclick="toggleWiderrufConsent()">
                <input type="checkbox" id="widerrufCheckbox">
                <label for="widerrufCheckbox">
                    Ich stimme zu, dass die Dienstleistung <strong>sofort beginnt</strong> und mein <a href="widerruf.html" target="_blank">Widerrufsrecht</a> damit erlischt.
                </label>
            </div>
            
            <div class="checkout-modal-buttons">
                <button class="btn-checkout-cancel" onclick="closeCheckoutModal()">Abbrechen</button>
                <button class="btn-checkout-confirm" id="btnCheckoutConfirm" onclick="proceedToCheckout()">Jetzt abonnieren</button>
            </div>
        </div>
    </div>

    <!-- Cookie Banner -->
    <div class="cookie-banner" id="cookieBanner">
        <div class="cookie-content">
            <div class="cookie-text">
                <h4>🍪 Cookie-Einstellungen</h4>
                <p>
                    Wir verwenden Cookies, um die Nutzung unserer Website zu analysieren und zu verbessern. 
                    Mit "Akzeptieren" stimmen Sie der Verwendung von Google Analytics zu. 
                    Mehr Informationen in unserer <a href="datenschutz.html">Datenschutzerklärung</a>.
                </p>
            </div>
            <div class="cookie-buttons">
                <button class="cookie-btn cookie-btn-decline" onclick="declineCookies()">Nur notwendige</button>
                <button class="cookie-btn cookie-btn-accept" onclick="acceptCookies()">Akzeptieren</button>
            </div>
        </div>
    </div>

    <script>
        // Cookie Banner Logic
        function showCookieBanner() {
            if (!localStorage.getItem('cookieConsent')) {
                document.getElementById('cookieBanner').classList.add('visible');
            }
        }

        function acceptCookies() {
            localStorage.setItem('cookieConsent', 'accepted');
            document.getElementById('cookieBanner').classList.remove('visible');
            loadGoogleAnalytics();
            
            // Track consent event
            if (window.gtag) {
                gtag('event', 'cookie_consent', {
                    'consent_type': 'accepted'
                });
            }
        }

        function declineCookies() {
            localStorage.setItem('cookieConsent', 'declined');
            document.getElementById('cookieBanner').classList.remove('visible');
        }

        // Zeige Banner nach kurzer Verzögerung
        setTimeout(showCookieBanner, 1000);

        // Event Tracking Funktionen (nur wenn Analytics geladen)
        function trackEvent(action, category, label) {
            if (window.gtag && localStorage.getItem('cookieConsent') === 'accepted') {
                gtag('event', action, {
                    'event_category': category,
                    'event_label': label
                });
            }
        }

        // Beispiel: Track wichtige Aktionen
        document.addEventListener('DOMContentLoaded', function() {
            // Track Abo-Button Klicks
            document.querySelectorAll('[onclick*="showCheckout"]').forEach(function(btn) {
                btn.addEventListener('click', function() {
                    trackEvent('click', 'conversion', 'abo_button');
                });
            });

            // Track Login
            document.querySelectorAll('[onclick*="showLogin"]').forEach(function(btn) {
                btn.addEventListener('click', function() {
                    trackEvent('click', 'engagement', 'login_button');
                });
            });
        });
    </script>
</body>
</html>
